---
title: "Final Project"
author: "Jihyun Lee"
date: "11/7/2020"
output:
  bookdown::pdf_document2:
    fig_caption: yes
    includes:
      in_header: ../addons/style.sty
    toc: no
    citation_package: biblatex
  pdf_document:
    toc: no
bibliography: ../addons/reference.bib
---

```{r message = F, warning = F}
library(dplyr)
library(kableExtra)
```


# Introduction

## Data

```{r, echo = F}
# Read data
red <- read.csv("../../F2020-SDSProject/Wine quality/winequality-red.csv", sep = ";")
white <- read.csv("../../F2020-SDSProject/Wine quality/winequality-white.csv", sep = ";")

# create wine type indicator (red = 1, white = 0: dummy variable)
red <- red %>% mutate(red = 1)
white <- white %>% mutate(red = 0)

# create a full dataset
data <- rbind(red, white)

# change to factor variable (dummy)
data <- data %>% mutate(red = as.factor(as.character(red))) 
#table(data$red)
```

This wine quality dataset is from [@Cortez2009].
The dataset includes *vinho verde*, a unique product from the Minho (northwest) region of Portugal. The data were collected from May/2004 to February/2007 using only protected designation of origin samples that were tested at the official certification entity (CVRVV). The CVRVV is an inter-professional organization with the goal of improving the quality and marketing of vinho verde. The data were recorded by a computerized system (iLab), which automatically manages the process of wine sample testing from producer requests to laboratory and sensory analysis.

The outcome variable is `wine quality`, which was measured by a minimum score of three sensory assessors using blind tastes in a scale that ranges from 0 (very bad) to 10 (excellent). 
There are 11 attributes of the wine based on physicochemical tests: fixed acidity, volatile acidity, citric acid, residual sugar, chlorides, free sulfur dioxide, total sulfur dioxide, density, pH, sulphates, and alcohol.
Originally, two datasets were created separately, one for red wine ($n = 1599$) and another for white wine ($n = 4988$). In this report, we use a merged dataset and create a dummy variable to indicate the wine type, `red`. 
Thus, in total, the dataset includes 11 numerical attributes (covariates), one dummy variable, and one numerical outcome. 
There is no missing value in this dataset.



1. Descriptive statistics 

Table 1 shows the descriptive statistics of 11 attributes by wine type.

```{r, echo=FALSE}
data_cov <- data[,c(1:11,13)]

options(dplyr.summarise.inform = FALSE)

## Min
Min <- data_cov %>% group_by(red) %>%
  summarise(across(fixed.acidity:alcohol, ~ min(.x))) %>%
   mutate_if(is.numeric, round, 3)
Min <- as.data.frame(t(as.matrix(Min)))
colnames(Min) <- c("Min", "Min")

## Max
Max <- data_cov %>% group_by(red) %>%
  summarise(across(everything(), ~  max(.x)))%>%
   mutate_if(is.numeric, round, 3)
Max <- as.data.frame(t(as.matrix(Max)))
colnames(Max) <- c("Max", "Max")

## Mean
Mean <- data_cov %>% group_by(red) %>%
  summarise(across(everything(), ~  mean(.x)))%>%
   mutate_if(is.numeric, round, 3)
Mean <- as.data.frame(t(as.matrix(Mean)))
colnames(Mean) <- c("Mean", "Mean")

Descriptive <- cbind(Min, Max, Mean)
White <- Descriptive[,c(1,3,5)]
Red <- Descriptive[,c(2,4,6)] 

Descriptive_f <- cbind(White, Red)[2:12,]


# Final table
kbl(Descriptive_f, caption = "Descriptive statistics of 11 attributes", label = "desc") %>% kable_paper() %>% 
  add_header_above(c("", "White" = 3, "Red" = 3)) 
```


2. Histogram


## Research Questions 